## 矩阵分解

**1. 技术背景：**

- 传统的协同过滤基于统计和共现，只关注行为模式，完全不关注标题/描述/内容/文本/标签等**语义信息**
- 协同过滤的稀疏性导致贡献信号弱，模型只能学习到“硬关联”，学不到“软相似”

------

**2. 经典模型**

- **FunkSVD**（2006）

  1）训练数据：用户 ID + 物品 ID + 真实评分（三元组）
  2）初始化：给每个用户 / 物品随机初始化一个低维隐向量（比如维度 k=10）
  3）定义 Loss：最小化「预测评分（用户向量・物品向量）」和「真实评分」的平方误差
  ![1770727741362](C:\Users\15301\AppData\Roaming\Typora\typora-user-images\1770727741362.png)

  4）优化：用 SGD 沿着梯度方向迭代更新隐向量，直到 Loss 收敛
  5）正则化：加 L2 正则防止过拟合

  - L1 正则惩罚项 = 所有参数的绝对值之和
  - L2 正则惩罚项 = 所有参数的平方之和

------

- **BiasSVD**（2009）
  - 技术背景：不同用户的评分习惯差异很大。有些用户天生就是“好人”，很少给低分；有些用户则比较严格，平均分都不高。同样，有些电影因为制作精良或者明星云集，普遍得到较高评分；而有些冷门或质量一般的电影则评分偏低。

  - 评分公式：![1770727646484](C:\Users\15301\AppData\Roaming\Typora\typora-user-images\1770727646484.png)

    **μ**是所有评分的全局平均值，反映了整个系统的评分水平；
    **bu**是用户的个人偏置，反映了该用户相对于平均水平是倾向于给高分还是低分；
    **bi**是物品的偏置，反映了该物品相对于平均水平是受欢迎还是不受欢迎

  - Loss：

    ![1770727933484](C:\Users\15301\AppData\Roaming\Typora\typora-user-images\1770727933484.png)

  - 将偏置参数与隐向量共同优化BiasSVD**（2009）

  - 技术背景：不同用户的评分习惯差异很大。有些用户天生就是“好人”，很少给低分；有些用户则比较严格，平均分都不高。同样，有些电影因为制作精良或者明星云集，普遍得到较高评分；而有些冷门或质量一般的电影则评分偏低。

  - 评分公式：![1770727646484](C:\Users\15301\AppData\Roaming\Typora\typora-user-images\1770727646484.png)

    **μ**是所有评分的全局平均值，反映了整个系统的评分水平；
    **bu**是用户的个人偏置，反映了该用户相对于平均水平是倾向于给高分还是低分；
    **bi**是物品的偏置，反映了该物品相对于平均水平是受欢迎还是不受欢迎

  - Loss：

    ![1770727933484](C:\Users\15301\AppData\Roaming\Typora\typora-user-images\1770727933484.png)

  - 将偏置参数与隐向量共同优化